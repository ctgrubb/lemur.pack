<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>binary_1d_example • lemur.pack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="binary_1d_example">
<meta property="og:description" content="lemur.pack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lemur.pack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/articles/popsim_hyperg.html">Binary Example using Hypergeometric</a>
    </li>
    <li>
      <a href="../articles/binary_1d_example.html">binary_1d_example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ctgrubb/lemur.pack/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="binary_1d_example_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>binary_1d_example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ctgrubb/lemur.pack/blob/master/vignettes/binary_1d_example.Rmd"><code>vignettes/binary_1d_example.Rmd</code></a></small>
      <div class="hidden name"><code>binary_1d_example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ctgrubb.github.io/lemur.pack/">lemur.pack</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div id="simple-1-dimensional-binary-example" class="section level1">
<h1 class="hasAnchor">
<a href="#simple-1-dimensional-binary-example" class="anchor"></a>Simple 1-dimensional Binary Example</h1>
<p>This vignette explains synthetic population sampling for the simplest case, where each individual is defined by one binary variable. The only piece of information used to inform what the population looks like is a simple random sample of size <em>n</em>, which can be thought of as an <em>n</em>-vector with sum <em>y</em>. Our goal is to synthesize populations of size <em>N</em> with sum <em>Y</em>.</p>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<p>The first thing we need is our sample, and thus we need to know our <em>true</em> population proportion. For starters lets fix the truth at <em>p = 0.5</em>, sample size at <em>10</em>, and simulate a population of size <em>100</em>. Lets work with a sample that has a 40%/60% split of classes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>
<span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span>

<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></code></pre></div>
</div>
<div id="calculating-the-posterior" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-the-posterior" class="anchor"></a>Calculating the Posterior</h2>
<p>In order to calculate the posterior, we need to decide what our likelihood and choice of prior are.</p>
<div id="likelihood" class="section level3">
<h3 class="hasAnchor">
<a href="#likelihood" class="anchor"></a>Likelihood</h3>
<p>Upon first inspection our best choice for the likelihood would be a hypergeometric distribution. This distribution, <em>Hypergeometric(N, Y, n)</em>, has a probability mass function of:</p>
<p><span class="math display">\[
\frac{{Y \choose y}{{N-Y} \choose {n-y}}}{N \choose n}
\]</span> It can be thought of as the probability of sampling <em>y</em> white balls in a sample of size <em>n</em> from a population of <em>N</em> balls, of which <em>Y</em> are white.</p>
<p>Since we observe a sample <strong>from</strong> the population, our population must have at least as many <em>1</em>s and <em>0</em>s as our sample. Let’s construct a <code>data.frame</code> with all the information we will need.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">y</span><span class="op">:</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">+</span><span class="va">y</span><span class="op">)</span>, LogLikelihood <span class="op">=</span> <span class="cn">NA</span>, LogPriorFlat <span class="op">=</span> <span class="cn">NA</span>, LogPriorUninformative <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df</span><span class="op">$</span><span class="va">LogLikelihood</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">lemur.pack</span><span class="fu">:::</span><span class="fu"><a href="../reference/loglik_binary_.html">loglik_binary_</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>, n <span class="op">=</span> <span class="va">n</span>, Y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="prior" class="section level3">
<h3 class="hasAnchor">
<a href="#prior" class="anchor"></a>Prior</h3>
<p>Lets start by using a flat prior. In log space this is actually just zero.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df</span><span class="op">$</span><span class="va">LogPriorFlat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">lemur.pack</span><span class="fu">:::</span><span class="fu"><a href="../reference/logprior_binary_flat_.html">logprior_binary_flat_</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Lets also add an uninformative prior.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df</span><span class="op">$</span><span class="va">LogPriorUninformative</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">lemur.pack</span><span class="fu">:::</span><span class="fu"><a href="../reference/logprior_binary_uninformative_.html">logprior_binary_uninformative_</a></span><span class="op">(</span><span class="va">N</span>, Y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="construction" class="section level3">
<h3 class="hasAnchor">
<a href="#construction" class="anchor"></a>Construction</h3>
<p>Now we can add the log-likelihood and log-prior to get the log-posterior for each value of <em>Y</em>, and create a plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"LogPrior"</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"Prior"</span>, names_prefix <span class="op">=</span> <span class="st">"LogPrior"</span>, 
               values_to <span class="op">=</span> <span class="st">"LogPrior"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>LogPosterior <span class="op">=</span> <span class="va">LogLikelihood</span> <span class="op">+</span> <span class="va">LogPrior</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    Likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">LogLikelihood</span><span class="op">)</span>,
    Posterior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">LogPosterior</span><span class="op">)</span>
  <span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></code></pre></div>
<p><img src="binary_1d_example_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div id="sampling" class="section level3">
<h3 class="hasAnchor">
<a href="#sampling" class="anchor"></a>Sampling</h3>
<p>Lets actually get samples. For illustration purposes, we shall first sample using a flat prior.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">flat_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc_binary.html">mcmc_binary</a></span><span class="op">(</span><span class="va">obs</span>, <span class="va">N</span>, prior <span class="op">=</span> <span class="st">"flat"</span>, nsteps <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>
<span class="va">Y_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">flat_samples</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="binary_1d_example_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
<p>Note this graph is centered at <em>Y</em> = 50. Does this make sense, considering our sample was not evenly split? No; lets try the uninformative prior.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">uninformative_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcmc_binary.html">mcmc_binary</a></span><span class="op">(</span><span class="va">obs</span>, <span class="va">N</span>, prior <span class="op">=</span> <span class="st">"uninformative"</span>, nsteps <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>
<span class="va">Y_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">uninformative_samples</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="binary_1d_example_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Christopher Grubb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
